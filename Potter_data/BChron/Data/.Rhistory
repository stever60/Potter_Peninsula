#List of sjro age-depth model runs
#clear previous console
remove (list = ls())
#clear plot window
dev.off()
# Clear plots
if(!is.null(dev.list())) dev.off()
library(rbacon) #require(rbacon)
#Yanou Lake - using DR=791+/-121 from Pablo paper instead of 900+/-100 from Roberts et al. (2017) for marine ages
Bacon("YANM5",depths.file=FALSE,thick=5,d.by=1,rotate.axes=TRUE,cc=3,
postbomb=4,rounded=2,
mem.mean=0.4,mem.strength=20,
acc.mean=50,yr.max=13000,
d.max=360, slump=c(40,189,252,256), #PCA>0.2 for terrestrial zone ash layers
res=1,title.location='topright',dark=0.5)
Bacon.cleanup()
#Yanou Lake - using DR=791+/-121 from Pablo paper instead of 900+/-100 from Roberts et al. (2017) for marine ages
Bacon("YANM5",depths.file=FALSE,thick=5,d.by=1,rotate.axes=TRUE,cc=3,
postbomb=4,rounded=2,
mem.mean=0.4,mem.strength=20,
acc.mean=20,yr.max=13000,
d.min=0, d.max=350, slump=c(40,189,250,256), #defined as PCA2>0.2
res=1,dark=0.5, height=30, title.location='topright',mgp=c(1.5, 0.7, 0))
#Yanou Lake - using DR=791+/-121 from Pablo paper instead of 900+/-100 from Roberts et al. (2017) for marine ages
Bacon("YANM5",depths.file=TRUE,thick=5,d.by=1,rotate.axes=TRUE,cc=3,
postbomb=4,rounded=2,
mem.mean=0.4,mem.strength=20,
acc.mean=20,yr.max=13000,
d.min=0, d.max=350, slump=c(40,189,250,256), #defined as PCA2>0.2
res=1,dark=0.5, height=30, title.location='topright',mgp=c(1.5, 0.7, 0))
#Yanou Lake - using DR=791+/-121 from Pablo paper instead of 900+/-100 from Roberts et al. (2017) for marine ages
Bacon("YANM5",depths.file=FALSE,thick=5,d.by=1,rotate.axes=TRUE,cc=3,
postbomb=4,rounded=2,
mem.mean=0.4,mem.strength=20,
acc.mean=20,yr.max=13000,
d.min=0, d.max=350, slump=c(40,189,250,256), #defined as PCA2>0.2
res=1,dark=0.5, height=30, title.location='topright',mgp=c(1.5, 0.7, 0))
setwd("/Users/Steve/")
library(rbacon)
Bacon("YANM5",depths.file=FALSE,thick=5,d.by=1,rotate.axes=TRUE,cc=3,
postbomb=4,rounded=2,
mem.mean=0.4,mem.strength=20,
acc.mean=20,yr.max=13000,
d.min=0, d.max=350, slump=c(40,189,250,256), #defined as PCA2>0.2
res=1,dark=0.5, height=30, title.location='topright',mgp=c(1.5, 0.7, 0),
mean.col="red", mean.lty="12")
#Yanou Lake - using DR=791+/-121 from Pablo paper instead of 900+/-100 from Roberts et al. (2017) for marine ages
Bacon("YANM5",depths.file=FALSE,thick=5,d.by=1,rotate.axes=TRUE,cc=3,
postbomb=4,rounded=2,
mem.mean=0.4,mem.strength=20,
acc.mean=20,yr.max=13000,
d.min=0, d.max=350, slump=c(40,189,250,256), #defined as PCA2>0.2
res=1,dark=0.5, height=30, title.location='topright',mgp=c(1.5, 0.7, 0),
mean.lty="solid")
#Yanou Lake - using DR=791+/-121 from Pablo paper instead of 900+/-100 from Roberts et al. (2017) for marine ages
Bacon("YANM5",depths.file=FALSE,thick=5,d.by=1,rotate.axes=TRUE,cc=3,
postbomb=4,rounded=2,
mem.mean=0.4,mem.strength=20,
acc.mean=20,yr.max=13000,
d.min=0, d.max=350, slump=c(40,189,250,256), #defined as PCA2>0.2
res=1,dark=0.5, height=30, title.location='topright',mgp=c(1.5, 0.7, 0),
mean.lty=1)
#Yanou Lake - using DR=791+/-121 from Pablo paper instead of 900+/-100 from Roberts et al. (2017) for marine ages
Bacon("YANM5",depths.file=FALSE,thick=5,d.by=1,rotate.axes=TRUE,cc=3,
postbomb=4,rounded=2,
mem.mean=0.4,mem.strength=20,
acc.mean=20,yr.max=13000,
d.min=0, d.max=350, slump=c(40,189,250,256), #defined as PCA2>0.2
res=1,dark=0.5, height=30, title.location='topright',mgp=c(1.5, 0.7, 0),
lty=1)
anou Lake - using DR=791+/-121 from Pablo paper instead of 900+/-100 from Roberts et al. (2017) for marine ages
Bacon("YANM5",depths.file=FALSE,thick=3,d.by=1,rotate.axes=TRUE,cc=3,
postbomb=4,rounded=2,
mem.mean=0.4,mem.strength=20,
acc.mean=20,yr.max=13000,
d.min=0, d.max=350, slump=c(40,189,250,256), #defined as PCA2>0.2
res=1,dark=0.5, height=30, title.location='topright',mgp=c(1.5, 0.7, 0))
#New BACON INTCAL / SH20
#sets working directory on mac
#old BACON location - setwd("/Users/Steve/Dropbox/BAS/Data/C14/MacBacon_2.2")
setwd("/Users/Steve/")
library(rbacon)
## FINAL MODELS
## KITE-M4: lake reservoir age of 700±100 years applied to bulk sediment age data above 20 cm,  hiatus at 5 cm 320 years
# KITE4.1 same as above but with calibrated modelled tephra ages (light blue) included for plotting
Bacon("KITE-M4",depths.file=FALSE,thick=3,rotate.axes=TRUE,cc=3,
postbomb=4,acc.mean=50,rounded=2,
mem.mean=0.4,mem.strength=20,yr.max=12000,
slump=c(10.5, 12.1, 32, 34.3, 54, 63.5),
d.min=0,d.max=80, hiatus.depths=5, hiatus.max=200,#boundary=5,
C14.border=rgb(0, 0, 1, 1),C14.col=rgb(0, 0, 1, 0.5),
cal.col=rgb(0, 0.5, 0.5, 0.5), cal.border=rgb(0, 0.5, 0.5, 1),
dark=0.5, height=15, title.location='topright',mgp=c(1.5, 0.7, 0))
Bacon.cleanup()
#clear plot window
dev.off()
#reset parameters to default
.pardefault <- par()
par(.pardefault)
setwd("/Users/Steve/")
library(rbacon)
#List of sjro age-depth model runs
#clear previous console
remove (list = ls())
#clear plot window
dev.off()
# Clear plots
if(!is.null(dev.list())) dev.off()
library(rbacon) #require(rbacon)
Bacon("KITE-M4",depths.file=FALSE,thick=3,rotate.axes=TRUE,cc=3,
postbomb=4,acc.mean=50,rounded=2,
mem.mean=0.4,mem.strength=20,yr.max=12000,
slump=c(10.5, 12.1, 32, 34.3, 54, 63.5),
d.min=0,d.max=80, hiatus.depths=5, hiatus.max=200,#boundary=5,
C14.border=rgb(0, 0, 1, 1),C14.col=rgb(0, 0, 1, 0.5),
cal.col=rgb(0, 0.5, 0.5, 0.5), cal.border=rgb(0, 0.5, 0.5, 1),
dark=0.5, height=15, title.location='topright',mgp=c(1.5, 0.7, 0))
Bacon("KITE-M4.1",depths.file=FALSE,thick=3,rotate.axes=TRUE,cc=3,
postbomb=4,acc.mean=50,rounded=2,
mem.mean=0.4,mem.strength=20,yr.max=12000,
slump=c(10.5, 12.1, 32, 34.3, 54, 63.5),
d.min=0,d.max=80, hiatus.depths=5, hiatus.max=200,#boundary=5,
C14.border=rgb(0, 0, 1, 1),C14.col=rgb(0, 0, 1, 0.5),
cal.col=rgb(0, 0.5, 0.5, 0.5), cal.border=rgb(0, 0.5, 0.5, 1),
dark=0.5, height=15, title.location='topright',mgp=c(1.5, 0.7, 0))
Bacon("YANM5",depths.file=FALSE,thick=3,d.by=1,rotate.axes=TRUE,cc=3,
postbomb=4,rounded=2,
mem.mean=0.4,mem.strength=20,
acc.mean=20,yr.max=13000,
d.min=0, d.max=350, slump=c(40,189,250,256), #defined as PCA2>0.2
res=1,dark=0.5, height=30, title.location='topright',mgp=c(1.5, 0.7, 0))
## FINAL MODELS
## KITE-M4: lake reservoir age of 700±100 years applied to bulk sediment age data above 20 cm,  hiatus at 5 cm 320 years
# KITE4.1 same as above but with calibrated modelled tephra ages (light blue) included for plotting
Bacon("KITE-M4.1",depths.file=FALSE,thick=3,rotate.axes=TRUE,cc=3,
postbomb=4,acc.mean=50,rounded=2,
mem.mean=0.4,mem.strength=20,yr.max=12000,
slump=c(10.5, 12.1, 32, 34.3, 54, 63.5),
d.min=0,d.max=80, hiatus.depths=5, hiatus.max=200,#boundary=5,
C14.border=rgb(0, 0, 1, 1),C14.col=rgb(0, 0, 1, 0.5),
cal.col=rgb(0, 0.5, 0.5, 0.5), cal.border=rgb(0, 0.5, 0.5, 1),
dark=0.5, height=15, title.location='topright',mgp=c(1.5, 0.7, 0))
Bacon("KITE-M4.1",depths.file=FALSE,thick=3,rotate.axes=TRUE,cc=3,
postbomb=4,acc.mean=50,rounded=2,
mem.mean=0.4,mem.strength=20,yr.max=12000,
slump=c(10.5, 12.1, 32, 34.3, 54, 63.5),
d.min=0,d.max=80, hiatus.depths=5, hiatus.max=200,#boundary=5,
C14.border=rgb(0, 0, 1, 1),C14.col=rgb(0, 0, 1, 0.5),
cal.col=rgb(0, 0.5, 0.5, 0.5), cal.border=rgb(0, 0.5, 0.5, 1),
dark=0.5, height=15, title.location='topright',mgp=c(1.5, 0.7, 0))
Bacon("KITE-M4.1",depths.file=FALSE,thick=3,rotate.axes=TRUE,cc=3,
postbomb=4,acc.mean=50,rounded=2,
mem.mean=0.4,mem.strength=20,yr.max=12000,
slump=c(10.5, 12.1, 32, 34.3, 54, 63.5),
d.min=0,d.max=80, hiatus.depths=5, hiatus.max=200,#boundary=5,
C14.border=rgb(0, 0, 1, 1),C14.col=rgb(0, 0, 1, 0.5),
cal.col=rgb(0, 0.5, 0.5, 0.5), cal.border=rgb(0, 0.5, 0.5, 1),
dark=0.5, height=15, title.location='topright',mgp=c(1.5, 0.7, 0))
Bacon("KITE-M4.1",depths.file=FALSE,thick=3,rotate.axes=TRUE,cc=3,
postbomb=4,acc.mean=50,rounded=2,
mem.mean=0.4,mem.strength=20,yr.max=12000,
slump=c(10.5, 12.1, 32, 34.3, 54, 63.5),
d.min=0,d.max=80, hiatus.depths=5, hiatus.max=200,#boundary=5,
C14.border=rgb(0, 0, 1, 1),C14.col=rgb(0, 0, 1, 0.5),
cal.col=rgb(0, 0.5, 0.5, 0.5), cal.border=rgb(0, 0.5, 0.5, 1),
dark=0.5, height=15, title.location='topright',mgp=c(1.5, 0.7, 0))
Bacon("KITE-M4",depths.file=FALSE,thick=3,rotate.axes=TRUE,cc=3,
postbomb=4,acc.mean=50,rounded=2,
mem.mean=0.4,mem.strength=20,yr.max=12000,
slump=c(10.5, 12.1, 32, 34.3, 54, 63.5),
d.min=0,d.max=80, hiatus.depths=5, hiatus.max=200,#boundary=5,
C14.border=rgb(0, 0, 1, 1),C14.col=rgb(0, 0, 1, 0.5),
cal.col=rgb(0, 0.5, 0.5, 0.5), cal.border=rgb(0, 0.5, 0.5, 1),
dark=0.5, height=15, title.location='topright',mgp=c(1.5, 0.7, 0))
## FINAL MODELS
## KITE-M4: lake reservoir age of 700±100 years applied to bulk sediment age data above 20 cm,  hiatus at 5 cm 320 years
# KITE4.1 same as above but with calibrated modelled tephra ages (light blue) included for plotting
Bacon("KITE-M4",depths.file=FALSE,thick=3,rotate.axes=TRUE,cc=3,
postbomb=4,acc.mean=50,rounded=2,
mem.mean=0.4,mem.strength=20,yr.max=12000,
slump=c(10.5, 12.1, 32, 34.3, 54, 63.5),
d.min=0,d.max=80, hiatus.depths=5, hiatus.max=200,#boundary=5,
C14.border=rgb(0, 0, 1, 1),C14.col=rgb(0, 0, 1, 0.5),
cal.col=rgb(0, 0.5, 0.5, 0.5), cal.border=rgb(0, 0.5, 0.5, 1),
dark=0.5, height=15, title.location='topright',mgp=c(1.5, 0.7, 0))
## FINAL MODELS
## KITE-M4: lake reservoir age of 700±100 years applied to bulk sediment age data above 20 cm,  hiatus at 5 cm 320 years
# KITE4.1 same as above but with calibrated modelled tephra ages (light blue) included for plotting
Bacon("KITE-M4",depths.file=FALSE,thick=3,rotate.axes=TRUE,cc=3,
postbomb=4,acc.mean=50,rounded=2,
mem.mean=0.4,mem.strength=20,yr.max=12000,
slump=c(10.5, 12.1, 32, 34.3, 54, 63.5),
d.min=0,d.max=80, hiatus.depths=5, hiatus.max=200,#boundary=5,
C14.border=rgb(0, 0, 1, 1),C14.col=rgb(0, 0, 1, 0.5),
cal.col=rgb(0, 0.5, 0.5, 0.5), cal.border=rgb(0, 0.5, 0.5, 1),
dark=0.5, height=15, title.location='topright',mgp=c(1.5, 0.7, 0))
## FINAL MODELS
## KITE-M4: lake reservoir age of 700±100 years applied to bulk sediment age data above 20 cm,  hiatus at 5 cm 320 years
# KITE4.1 same as above but with calibrated modelled tephra ages (light blue) included for plotting
Bacon("KITE-M4",depths.file=TRUE,thick=3,rotate.axes=TRUE,cc=3,
postbomb=4,acc.mean=50,rounded=2,
mem.mean=0.4,mem.strength=20,yr.max=12000,
slump=c(10.5, 12.1, 32, 34.3, 54, 63.5),
d.min=0,d.max=80, hiatus.depths=5, hiatus.max=200,#boundary=5,
C14.border=rgb(0, 0, 1, 1),C14.col=rgb(0, 0, 1, 0.5),
cal.col=rgb(0, 0.5, 0.5, 0.5), cal.border=rgb(0, 0.5, 0.5, 1),
dark=0.5, height=15, title.location='topright',mgp=c(1.5, 0.7, 0))
## FINAL MODELS
## KITE-M4: lake reservoir age of 700±100 years applied to bulk sediment age data above 20 cm,  hiatus at 5 cm 320 years
# KITE4.1 same as above but with calibrated modelled tephra ages (light blue) included for plotting
Bacon("KITE-M4",depths.file=TRUE,thick=3,rotate.axes=TRUE,cc=3,
postbomb=4,acc.mean=50,rounded=2,
mem.mean=0.4,mem.strength=20,yr.max=12000,
slump=c(10.5, 12.1, 32, 34.3, 54, 63.5),
d.min=0,d.max=80, hiatus.depths=5, hiatus.max=200,#boundary=5,
C14.border=rgb(0, 0, 1, 1),C14.col=rgb(0, 0, 1, 0.5),
cal.col=rgb(0, 0.5, 0.5, 0.5), cal.border=rgb(0, 0.5, 0.5, 1),
dark=0.5, height=15, title.location='topright',mgp=c(1.5, 0.7, 0))
install.packages("standardize")
setwd("/Users/Steve/Dropbox/BAS/Data/R/Clustering")
#check working directory
getwd()
#clear previous console
remove (list = ls())
#clear plot window
dev.off()
#load vegan and rijoa libraries
library (vegan)
library (rioja)
library(standardize)
# Import data - remove columns -  standardise data to z-scores if needed
x.raw <- read.csv("KITE_Diatoms_%.csv",
header=TRUE, row.names=1, sep=",", check.names=FALSE)
summary(x.raw)
standardize(x, centerFun = mean, scaleFun = sd)
standardize(x.raw, centerFun = mean, scaleFun = sd)
setwd("/Users/Steve/")
library(rbacon)
#set working directory on mac - this is where Bacon_runs folder is now located
# ****remember to copy this folder across to Dropbox regularly for back it up ****
#install key packages
install.packages(
c("tidyr", "dplyr", "ggplot2", "ggfortify", "ggsci", "GGally", "ggpubr",
"ggpmisc", "ggfortify", "ellipse","strucchange", "factoextra",
"car","cowplot", "mgcv", "rcarbon",  "reshape2",
"magrittr", "gridExtra", "gtable", "devtools", "corrplot",
"chemometrics", "stringr", "egg", "grid"))
#install specific work packages
install.packages(
c("Bchron", "rcarbon", "rbacon", "vegan", "rioja", "itraxR",
"tidypaleo", "changepoint", "gam"))
#install colour packages
install.packages(
c("wesanderson", "viridis", "RColorBrewer"))
install.packages("Matrix")
install.packages("datapasta")
install.packages("norrrm")
tinytex:::is_tinytex()
knitr::opts_chunk(message = FALSE, warning=FALSE, echo=FALSE)
library(tidyverse)
M <- lm(len ~ dose * supp, data = ToothGrowth)
summary(M)
summary(M)$coefficients
head(ToothGrowth)
ggplot(ToothGrowth,
aes(x = dose, y = len, colour = supp,
group = interaction(supp,dose)
)
) + geom_boxplot() + theme_classic()
install.packages("knitr")
knitr::opts_chunk$set(message = FALSE, warning = FALSE, echo = FALSE)
#load tidyverse
library(tidyverse)
head(ToothGrowth)
ggplot(ToothGrowth,
aes(x = dose, y = len, colour = supp,
group = interaction(supp,dose)
)
) + geom_boxplot() + theme_classic()
M <- lm(len ~ dose * supp, data = ToothGrowth)
S <- summary(M)
kable(S$coefficients, digits = 2)
knitr::opts_chunk$set(message = FALSE, warning = FALSE, echo = FALSE)
install.packages("tinytex")
tinytex:::is_tinytex()
writeLines("Hello $x^2$", 'test.Rmd')
rmarkdown::render("test.Rmd", output_format = "pdf_document")
install.packages("citr")
install.packages("itraxR")
install.packages("factoextra")
install.packages("datapasta")
install.packages("MASS")
# install latest github version of ITRAX R
remotes::install_github("tombishop1/itraxR")
install.packages("Hmisc")
#clear previous console
remove (list = ls())
#clear plot window
dev.off()
#Load packages needed
library(Bchron)
library(rcarbon)
library(cowplot) # for plotting
library (dplyr)
library (tidyr)
library (ggplot2)
library (parameters)
library (mclust)
library (NbClust)
library (cluster)
#sets the working directory on desktop
#setwd("c:\\data\\R\\BChron")
#sets working directory on mac
setwd("/Users/Steve/Dropbox/BAS/Data/R/BChron/Data")
#check working directory
getwd()
#clear previous console
remove (list = ls())
##  STANDARD PLOTTING SIZE - set to 8 cm width to match Sigmaplot output for -100 a to 12 ka
# Clear plots
if(!is.null(dev.list())) dev.off()
## Translate 8 cm graph plot size *from* cm *to* inches:
plotinch <- 8 / cm(1) # -> 8 cm  is  3.149608 inches but R converts to 3.149606 -
plotinch_x <- 9 / cm(1)
plotinch_y <- 7 / cm(1)
## FINAL PLOT TO PDF
#mai / omi = margin in inches or mar / oma = margin in lines - order is bottom, left, top, right
#set up the page layout - A4 is 8.27 x 11.69 - closest to
#pdf("output.pdf", pointsize=12,  width = 8.27, height = 11.69) #will fit to t
layout(matrix(1:2, ncol=1)) # Set up layout
#par(mai=c(4,4,3,4), pin=c(plotinch, plotinch/2), xaxs='i') #plot size in inches
par(mai=c(0.1,0.25,0.25,0.25), pin=c(plotinch, plotinch/2),  mgp=c(2,0.5,0), xaxs='i', omi=c(0,0,0,0))
#dev.off() #need to include this to write to pdf file fully - will delete screen plot
# ++++++++++++++++++++++++++++++  Combined density analysis   +++++++++++++++++++++++++++++++++++++++++++++++++
#The BchronDensity:Non-parametric phase model function runs a non-parametric phase model on 14C
#and non-14C ages via Gaussian Mixture density estimation
#This model places a Gaussian mixture prior distribution on the calibrated ages and so estimates the density of
#the overall set of radiocarbon ages. It is designed to be a probabilistic version of the Oxcal SUM command which
#takes calibrated ages and sums the probability distributions with the aim of estimating activity through age as
#a proxy.
#An object of class BchronDensityRun with the following elements is produced:
#theta = The posterior samples of the restricted ages
#p = Posterior samples of the mixture proportions
#mu = Values of the means of each Gaussian mixture
#calAges = The calibrated ages from BchronCalibrate
#G = The number of mixture components. Equal to numMix
#age_grid = A grid of ages used for the final density estimate
#density = The density estimate based on the above age grid
# SECTION 1
# +++++++++ FILDES, POTTER, KGI & SSI  DATA CALIBRATION AND INITIAL PLOTTING ++++++++++
#sets working directory on mac
setwd("/Users/Steve/Dropbox/BAS/Data/R/BChron/Data")
#check working directory
getwd()
#clear previous console
remove (list = ls())
#clear plot window
dev.off()
# Clear plots
if(!is.null(dev.list())) dev.off()
# Read in data from ARTIGAS terrestrial mosses and marine shells fragments (as an example)
x2 <- read.csv("ART_Terr20.csv")
x2.1 <- read.csv("ART_Hall_Terr20.csv")
x4 <- read.csv("ART_Mar20666.csv")
# Compare with published data from Fildes, Potter, KGI, SSI
x6 <- read.csv("Advance_Potter.csv")
x7 <- read.csv("Advance_Fildes.csv")
x8 <- read.csv("Advance_KGI.csv") #Advane_KGI is the same dataset as Advance_SSI as all ages are on KGI
x9 <- read.csv("Retreat_KGI.csv")
x10 <- read.csv("Retreat_SSI.csv")
x11 <- read.csv("Aq_Moss_KGI.csv")
x12 <- read.csv("Aq_Moss_SSI.csv")
# Compare with published data from Fildes, Potter, KGI, SSI
x13 <- read.csv("Cosmo_Fildes.csv")
x13b <- read.csv("Cosmo_Potter.csv")
x14 <- read.csv("Cosmo_KGI.csv")
# Compare with additional data from Fildes
x15 <- read.csv("Lakes_basal_Fildes.csv")
x16 <- read.csv("Aq_Moss_Fildes.csv")
x17 <- read.csv("Retreat_KGI_earlyHolocene.csv")
x20 <- read.csv("Kaplan2020_JRI_Advance.csv")
x21 <- read.csv("Kaplan2020_JRI_Retreat.csv")
x22 <- read.csv("WAIS_volcanic_flux.csv")
# Calibrate the ages
xAges2 <- with (x2, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges2.1 <- with (x2.1, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges4 <- with (x4, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges6 <- with (x6, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges7 <- with (x7, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges8 <- with (x8, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges9 <- with (x9, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges10 <- with (x10, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges11 <- with (x11, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges12 <- with (x12, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges13 <- with (x13, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges13b <- with (x13b, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges14 <- with (x14, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges15 <- with (x15, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges16 <- with (x16, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges17 <- with (x17, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges20 <- with (x20, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xAges21 <- with (x21, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
plot(xAges17, withPositions = TRUE)
xDens13 <- with(x13, BchronDensity(ages = ages, ageSds = ageSds,calCurves = calCurves, numMix = 5)) #final plot
xDens13b <- with(x13b, BchronDensity(ages = ages, ageSds = ageSds,calCurves = calCurves, numMix = 5)) #final plot
xDens14 <- with(x14, BchronDensity(ages = ages, ageSds = ageSds,calCurves = calCurves, numMix = 10)) #final plot
xDens17 <- with(x17, BchronDensity(ages = ages, ageSds = ageSds,calCurves = calCurves, numMix = 10)) #final table
summary(xDens17, type = "outliers", prob = 0.95) # Look at outlier probabilities
# Clear plots
if(!is.null(dev.list())) dev.off()
## Translate 8 cm graph plot size *from* cm *to* inches:
plotinch <- 8 / cm(1) # -> 8 cm  is  3.149606 inches
plotinch
# if the pdf A4 width is 8.27 inches the l and right margins are then b
# total pdf width - plot width then divide by 2 to give margin width on each size
# then -1 to for mai = 1 inch left and right
b <- ((8.27-plotinch)/2)-1
checksize <- b*2+plotinch+2
checksize #should = 8.27 inches A4 width
## FINAL PLOT TO PDF
#mai / omi = margin in inches or mar / oma = margin in lines - order is bottom, left, top, right
#set up the page layout - A4 is 8.27 x 11.69 - closest to
pdf("output.pdf", pointsize=12,  width = 8.27, height = 11.69) #will fit to t
layout(matrix(1:3, ncol=1)) # Set up layout
#par(mai=c(4,4,3,4), pin=c(plotinch, plotinch/2), xaxs='i') #plot size in inches
par(mai=c(0.1,0.25,0.25,0.25), omi=c(0,0,0,0), pin=c(plotinch, plotinch/2), mgp=c(2,0.5,0), xaxs='i') # Set up internal margins
#xas = "i" tells plot device not to add 4% extra internal margin (which default plot style in R)
#  PLOT TO SCREEN FIRST
# Clear plots
if(!is.null(dev.list())) dev.off()
# plot XDens output together for comparison
layout(matrix(1:3, ncol=1)) # Set up layout
#par(mai=c(4,4,3,4), pin=c(plotinch, plotinch/2), xaxs='i') #plot size in inches
par(mai=c(0.1,0.25,0.25,0.25), pin=c(plotinch, plotinch/2),  mgp=c(2,0.5,0), xaxs='i', omi=c(0,0,0,0))
# mai sets up internal margins around plot in inches
# pin sets up the size of the plot in inches - here its 8 cm wide by 8/3 cm high
# mgp sets: axis label distance from axis, tick labels from ticks, tick distance from the line
# xas = "i" tells plot device not to add 4% extra internal margin (which default plot style in R)
# omi sets up internal margin around output in inches
# example of math equation as text in graph
# text(7, 4, expression(bar(x) == sum(frac(x[i], n), i==1, n))) - or expression(hat(beta) == (X^t * X)^{-1} * X^t * y)
# for text: font = 2 is bold, 3 is italic, 4 is bold italic
# baseline Potter C14 ages prob plot
p6 <- plot(xDens6, main="Potter Peninsula: max. age constraints on glacier advance",
xlab="Age [a BP]", xlim = c(-100, 12000),
tck=-0.04, panel.first = grid(nx = NULL, col = "lightgray", lty = "dotted"))
xAges6 <- with (x6, BchronCalibrate(ids = id, ages = ages, ageSds = ageSds,positions = position, calCurves = calCurves, allowOutside = TRUE))
xDens6 <- with(x6, BchronDensity(ages = ages, ageSds = ageSds,calCurves = calCurves, numMix = 30)) #final plot
xDens8 <- with(x8, BchronDensity(ages = ages, ageSds = ageSds,calCurves = calCurves, numMix = 80)) #final plot
# baseline Potter C14 ages prob plot
p6 <- plot(xDens6, main="Potter Peninsula: max. age constraints on glacier advance",
xlab="Age [a BP]", xlim = c(-100, 12000),
tck=-0.04, panel.first = grid(nx = NULL, col = "lightgray", lty = "dotted"))
par(new = TRUE) #hold the plot frame to add median values
p_axis <- c(axis(1, seq(0,12000,2000), tck=-0.04), axis(1, seq(0,12000,500),labels=rep("",25), tck=-0.02),
axis(2, seq(0,0.015,0.001), labels=rep("",16), tck=-0.02),
axis(3, seq(0,12000,2000), labels=rep("",7), tck=0.04),axis(3, seq(0,12000,500),labels=rep("",25), tck=0.02),
axis(4, seq(0,0.015,0.001), labels=rep("",16), tck=0.02))
par(new = FALSE) #remove hold on the plot frame to add median values
# Add Potter He-3 cosmo ages to plot 5 on secondary axis of altitude
par(new=TRUE)
x <- x13b$ages
#y <- c(0.004, 0.005, 0.006)
y <- x13b$altitude
x.err <- x13b$ageSds
#arrows(x0=x-x.err, y0=y, x1=x+x.err, code=3, angle=90, length = 0.00)
#points(x, y, pch = 21, col= "black", bg = "red", cex=2)
plot(x, y, pch = 21, col= "black", bg= "darkred", cex = 1,
xlab = "", ylab = "", xlim=c(-100,12000), ylim=c(0,200), axes = FALSE)
arrows(x0=x-x.err, y0=y, x1=x+x.err, code=3, angle=90, length = 0.00, col= "darkgrey", lwd = 1)
par(new=TRUE)
plot(x, y, pch = 21, col= "red", bg= "red", cex = 1,
xlab = "", ylab = "", xlim=c(-100,12000), ylim=c(0,200), axes = FALSE)
axis(4,  ylim=c(0,200), col = "grey", col.lab = "grey", col.axis = "grey")
mtext("Altitude (m a.s.l.)", side=4, line=2, col = "grey", cex = 0.75)
par(new = FALSE) #remove hold on the plot frame to add median values
# Add new Fildes new cosmo ages to secondary axis of altitude
par(new=TRUE)
x <- x13$ages
#y <- c(0.004, 0.005, 0.006)
y <- x13$altitude
x.err <- x13$ageSds
#arrows(x0=x-x.err, y0=y, x1=x+x.err, code=3, angle=90, length = 0.00)
#points(x, y, pch = 21, col= "black", bg = "red", cex=2)
plot(x, y, pch = 21, col= "blue", bg= "blue", cex = 1,
xlab = "", ylab = "", xlim=c(-100,12000), ylim=c(0,200), axes = FALSE)
arrows(x0=x-x.err, y0=y, x1=x+x.err, code=3, angle=90, length = 0.00, col= "darkgrey", lwd = 1)
par(new=TRUE)
plot(x, y, pch = 21, col= "blue", bg= "blue", cex = 1,
xlab = "", ylab = "", xlim=c(-100,12000), ylim=c(0,200), axes = FALSE)
axis(4,  ylim=c(0,200), col = "grey", col.lab = "grey", col.axis = "grey")
mtext("Altitude (m a.s.l.)", side=4, line=2, col = "grey", cex = 0.75)
par(new = FALSE) #remove hold on the plot frame to add median values
# KGI early holocene deglacaition constraints -  new cosmo ages to secondary axis of altitude
par(new=TRUE)
x <- x17$ages
#y <- c(0.004, 0.005, 0.006)
y <- x17$altitude
x.err <- x17$ageSds
#arrows(x0=x-x.err, y0=y, x1=x+x.err, code=3, angle=90, length = 0.00)
#points(x, y, pch = 21, col= "black", bg = "red", cex=2)
plot(x, y, pch = 21, col= "black", bg= "black", cex = 1,
xlab = "", ylab = "", xlim=c(-100,12000), ylim=c(0,200), axes = FALSE)
arrows(x0=x-x.err, y0=y, x1=x+x.err, code=3, angle=90, length = 0.00, col= "darkgrey", lwd = 1)
par(new=TRUE)
plot(x, y, pch = 21, col= "black", bg= "black", cex = 1,
xlab = "", ylab = "", xlim=c(-100,12000), ylim=c(0,200), axes = FALSE)
axis(4,  ylim=c(0,200), col = "grey", col.lab = "grey", col.axis = "grey")
mtext("Altitude (m a.s.l.)", side=4, line=2, col = "grey", cex = 0.75)
par(new = FALSE) #remove hold on the plot frame to add median values
# Reference list of in datafiles
x1 <- read.csv("ART_Terr13.csv")
